(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{lJKv:function(n,t,l){"use strict";l.r(t);var i=l("CcnG"),o=function(){return function(){}}(),e=l("pMnS"),u=l("LWQm"),a=l("Ip0R"),r=l("d/rN"),c=function(){function n(n){this.dialog=n}return n.prototype.openDialog=function(){this.dialog.open(r.a)},n.prototype.ngOnInit=function(){},n}(),s=l("o3x0"),b=i.qb({encapsulation:0,styles:['.notification__container[_ngcontent-%COMP%] {\n        display: flex;\n        width: 400px;\n        min-height: 64px;\n        align-items: center;\n        padding: 8px;\n        box-shadow: var(--primary-box-shadow);\n        \n        background-color: white;\n        cursor: pointer;\n      }\n\n      .notification-thumb[_ngcontent-%COMP%] {\n        width: 48px;\n        height: 48px;\n        border-radius: 50%;\n        position: relative;\n        background-size: cover;\n        background-position: center;\n      }\n\n      .notification-thumb[_ngcontent-%COMP%]::before {\n        content: "";\n        position: absolute;\n        top: 0px;\n        left: 0px;\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n        background: linear-gradient(\n          305.27deg,\n          rgba(0, 0, 0, 0.7) 0.19%,\n          rgba(0, 0, 0, 0) 54.37%\n        );\n      }\n\n      .notification-body[_ngcontent-%COMP%] {\n        width: calc(100% - 48px);\n        padding: 0 0 0 8px;\n      }\n\n      .notification-text[_ngcontent-%COMP%] {\n        font-size: 0.8rem;\n        margin-bottom: 0.5rem;\n      }\n\n      .notification-timestamp[_ngcontent-%COMP%] {\n        font-size: 0.7rem;\n        color: rgba(0, 0, 0, 0.5);\n      }'],data:{}});function f(n){return i.Mb(0,[i.Eb(0,u.a,[]),i.Eb(0,u.b,[]),(n()(),i.sb(2,0,null,null,10,"div",[["class","notification__container"]],null,[[null,"click"]],function(n,t,l){var i=!0;return"click"===t&&(i=!1!==n.component.openDialog()&&i),i},null,null)),(n()(),i.sb(3,0,null,null,2,"div",[["class","notification-thumb"]],null,null,null,null,null)),i.rb(4,278528,null,0,a.q,[i.v,i.k,i.G],{ngStyle:[0,"ngStyle"]},null),i.Fb(5,{"background-image":0}),(n()(),i.sb(6,0,null,null,6,"div",[["class","notification-body"]],null,null,null,null,null)),(n()(),i.sb(7,0,null,null,1,"div",[["class","notification-text"]],null,null,null,null,null)),(n()(),i.Kb(8,null,["",""])),(n()(),i.sb(9,0,null,null,3,"div",[["class","notification-timestamp"]],null,null,null,null,null)),(n()(),i.Kb(10,null,[" "," "])),i.Gb(11,1),i.Gb(12,2)],function(n,t){var l=t.component,i=n(t,5,0,"url("+(null==l.notification?null:l.notification.thumb)+"), url(../../../assets/images/resource_default.jpeg)");n(t,4,0,i)},function(n,t){var l=t.component;n(t,8,0,null==l.notification?null:l.notification.text);var o=i.Lb(t,10,0,n(t,12,0,i.Cb(t,0),i.Lb(t,10,0,n(t,11,0,i.Cb(t,1),null==l.notification?null:l.notification.timestamp)),"LLL"));n(t,10,0,o)})}var p=l("NvT6"),d=l("Blfk"),g=l("dWZg"),h=l("wFw1"),m=l("bujt"),v=l("UodH"),S=l("lLAP"),_=l("dU8u"),C=l("mrSG"),O=l("qIOU"),y=(l("ey9i"),l("xMyE")),x=l("t9fZ"),w=l("9Z1F"),M=l("15JJ"),j=l("26FU"),A=l("F/XL"),k=function(){function n(n,t,l){this.authService=n,this.profileService=t,this.notificationService=l,this.notificationSubject=new j.a([]),this.notification$=this.notificationSubject.asObservable(),this.loading=new j.a(!0),this.loading$=this.loading.asObservable(),this.error=!1,this.infiniteDisable=!0,this.scrollCount=0,this.lastNotificationValue=0,this.isEmpty=!1,this.isComplete=!1}return n.prototype.nextBatch=function(){var n=this;this.scrollCount++,this.scrollCount>2?this.infiniteDisable=!0:(console.log("next batch"),this.loading.next(!0),this.notificationService.getNotifications({mode:"scroll",user_id:this.user_id,notification_id:this.lastNotificationValue.toString()}).pipe(Object(y.a)(function(t){console.log({data:t});var l=t||[],i=n.notificationSubject.getValue();n.notificationSubject.next(i.concat(l));var o=(l[l.length-1]||{}).value,e=void 0===o?0:o;console.log({value:e}),n.updateState(e),(0==l.length||l.length<10)&&n.setCompleteState()}),Object(x.a)(1),Object(w.a)(function(t){return n.setErrorStatus(t,"Something went wrong!"),n.notificationSubject.next([]),Object(A.a)({notifications:[]})})).subscribe())},n.prototype.resetInfinite=function(){this.infiniteDisable=!1,this.scrollCount=0,this.nextBatch()},n.prototype.setErrorStatus=function(n,t){console.log({err:n}),this.loading.next(!1),this.error=!0,console.log({err:n}),this.errorMessage=t},n.prototype.updateState=function(n){this.loading.next(!1),this.lastNotificationValue=n},n.prototype.setEmptyState=function(){this.isEmpty=!0,this.infiniteDisable=!0,this.loading.next(!1)},n.prototype.setCompleteState=function(){this.infiniteDisable=!0,this.isComplete=!0},n.prototype.setContinueState=function(){this.infiniteDisable=!1},n.prototype.init=function(){return C.__awaiter(this,void 0,void 0,function(){var n,t=this;return C.__generator(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.profileService.getUser()];case 1:return l.sent().pipe(Object(y.a)(function(n){t.user_id=n._id}),Object(M.a)(function(n){return t.notificationService.getNotifications({user_id:n._id})}),Object(y.a)(function(n){console.log({data:n});var l=n||[];t.notificationSubject.next(l);var i=(l[l.length-1]||{}).value,o=void 0===i?0:i;console.log({value:o}),t.updateState(o),0===l.length?t.setEmptyState():l.length<10?t.setCompleteState():10===l.length&&t.setContinueState()}),Object(x.a)(1),Object(w.a)(function(n){return 404!==n.status?t.setErrorStatus(n,"Something went wrong!"):t.setEmptyState(),t.notificationSubject.next([]),Object(A.a)({notifications:[]})})).subscribe(),[3,3];case 2:return n=l.sent(),console.log(n),[3,3];case 3:return[2]}})})},n.prototype.ngOnInit=function(){this.init()},n}(),I=l("FFoR"),E=l("Y4+Y"),P=i.qb({encapsulation:0,styles:[[".notification-list__container[_ngcontent-%COMP%]{min-height:calc(100vh - 60px);display:grid;width:100%;place-items:center;place-content:center;align-content:start;grid-template-columns:400px;gap:1rem 0;padding:1rem 0}.load__btn[_ngcontent-%COMP%], .loading-spinner[_ngcontent-%COMP%]{display:grid;padding:1rem 0;place-items:center}.load__btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#1a1a96;color:#fff}.notification-error[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--danger-color)}"]],data:{}});function D(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,1,"app-notification",[],null,null,null,f,b)),i.rb(1,114688,null,0,c,[s.e],{notification:[0,"notification"]},null)],function(n,t){n(t,1,0,t.context.$implicit)},null)}function F(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,1,"div",[["class","notification-error"]],null,null,null,null,null)),(n()(),i.Kb(-1,null,[" Something went wrong! "]))],null,null)}function N(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,1,"div",[["class","notification-placeholder"]],null,null,null,null,null)),(n()(),i.Kb(-1,null,[" Your notifications appear here. "]))],null,null)}function L(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,2,"div",[["class","notification-complete"]],null,null,null,null,null)),(n()(),i.sb(1,0,null,null,1,"b",[],null,null,null,null,null)),(n()(),i.Kb(-1,null,["You're all caught up!"]))],null,null)}function z(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,2,"div",[["class","loading-spinner"]],null,null,null,null,null)),(n()(),i.sb(1,0,null,null,1,"mat-spinner",[["class","mat-spinner mat-progress-spinner"],["diameter","50"],["mode","indeterminate"],["role","progressbar"]],[[2,"_mat-animation-noopable",null],[4,"width","px"],[4,"height","px"]],null,null,p.b,p.a)),i.rb(2,49152,null,0,d.d,[i.k,g.a,[2,a.d],[2,h.a],d.a],{diameter:[0,"diameter"]},null)],function(n,t){n(t,2,0,"50")},function(n,t){n(t,1,0,i.Cb(t,2)._noopAnimations,i.Cb(t,2).diameter,i.Cb(t,2).diameter)})}function K(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,2,"button",[["mat-stroked-button",""]],[[8,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(n,t,l){var i=!0;return"click"===t&&(i=!1!==n.component.resetInfinite()&&i),i},m.d,m.b)),i.rb(1,180224,null,0,v.b,[i.k,g.a,S.e,[2,h.a]],null,null),(n()(),i.Kb(-1,0,[" Load More Notifications "]))],null,function(n,t){n(t,0,0,i.Cb(t,1).disabled||null,"NoopAnimations"===i.Cb(t,1)._animationMode)})}function Y(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,13,"div",[["class","notification-list__container"],["infinite-scroll",""]],null,[[null,"scrolled"]],function(n,t,l){var i=!0;return"scrolled"===t&&(i=!1!==n.component.nextBatch()&&i),i},null,null)),i.rb(1,4866048,null,0,_.a,[i.k,i.B],{infiniteScrollDistance:[0,"infiniteScrollDistance"],infiniteScrollThrottle:[1,"infiniteScrollThrottle"],infiniteScrollDisabled:[2,"infiniteScrollDisabled"]},{scrolled:"scrolled"}),(n()(),i.kb(16777216,null,null,2,null,D)),i.rb(3,278528,null,0,a.m,[i.S,i.O,i.u],{ngForOf:[0,"ngForOf"]},null),i.Eb(131072,a.b,[i.h]),(n()(),i.kb(16777216,null,null,1,null,F)),i.rb(6,16384,null,0,a.n,[i.S,i.O],{ngIf:[0,"ngIf"]},null),(n()(),i.kb(16777216,null,null,1,null,N)),i.rb(8,16384,null,0,a.n,[i.S,i.O],{ngIf:[0,"ngIf"]},null),(n()(),i.kb(16777216,null,null,1,null,L)),i.rb(10,16384,null,0,a.n,[i.S,i.O],{ngIf:[0,"ngIf"]},null),(n()(),i.kb(16777216,null,null,2,null,z)),i.rb(12,16384,null,0,a.n,[i.S,i.O],{ngIf:[0,"ngIf"]},null),i.Eb(131072,a.b,[i.h]),(n()(),i.sb(14,0,null,null,2,"div",[["class","load__btn"]],null,null,null,null,null)),(n()(),i.kb(16777216,null,null,1,null,K)),i.rb(16,16384,null,0,a.n,[i.S,i.O],{ngIf:[0,"ngIf"]},null)],function(n,t){var l=t.component;n(t,1,0,1,1e3,l.infiniteDisable),n(t,3,0,i.Lb(t,3,0,i.Cb(t,4).transform(l.notification$))),n(t,6,0,l.error),n(t,8,0,l.isEmpty),n(t,10,0,l.isComplete),n(t,12,0,i.Lb(t,12,0,i.Cb(t,13).transform(l.loading$))),n(t,16,0,l.infiniteDisable&&!l.isEmpty&&!l.isComplete)},null)}function G(n){return i.Mb(0,[(n()(),i.sb(0,0,null,null,1,"app-notification-list",[],null,null,null,Y,P)),i.rb(1,114688,null,0,k,[O.a,I.a,E.a],null,null)],function(n,t){n(t,1,0)},null)}var q=i.ob("app-notification-list",k,G,{},{},[]),B=l("29pW"),J=l("Wf4p"),U=l("ZYCi"),V=l("oX4v"),Z={authGuardPipe:function(){return Object(V.c)(["login"])}},$=function(){return function(){}}(),W=l("Fzqc"),T=l("ZYjt"),R=l("FVSy"),X=l("/dO6"),H=l("SMsm"),Q=l("PCNd"),nn=l("YSh2");l.d(t,"NotificationModuleNgFactory",function(){return tn});var tn=i.pb(o,[],function(n){return i.zb([i.Ab(512,i.j,i.fb,[[8,[e.a,q,B.a]],[3,i.j],i.z]),i.Ab(4608,a.p,a.o,[i.w,[2,a.z]]),i.Ab(4608,J.b,J.b,[]),i.Ab(1073742336,a.c,a.c,[]),i.Ab(1073742336,U.s,U.s,[[2,U.y],[2,U.o]]),i.Ab(1073742336,$,$,[]),i.Ab(1073742336,_.b,_.b,[]),i.Ab(1073742336,W.a,W.a,[]),i.Ab(1073742336,J.j,J.j,[[2,J.c],[2,T.h]]),i.Ab(1073742336,d.c,d.c,[]),i.Ab(1073742336,u.c,u.c,[]),i.Ab(1073742336,g.b,g.b,[]),i.Ab(1073742336,J.s,J.s,[]),i.Ab(1073742336,v.c,v.c,[]),i.Ab(1073742336,R.g,R.g,[]),i.Ab(1073742336,X.d,X.d,[]),i.Ab(1073742336,H.c,H.c,[]),i.Ab(1073742336,Q.a,Q.a,[]),i.Ab(1073742336,o,o,[]),i.Ab(1024,U.m,function(){return[[{path:"",component:k,canActivate:[V.a],data:Z}]]},[]),i.Ab(256,X.a,{separatorKeyCodes:[nn.f]},[])])})}}]);